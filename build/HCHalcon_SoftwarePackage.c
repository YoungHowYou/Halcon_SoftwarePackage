/***********************************************************
 * File generated by the HALCON-Compiler hcomp version 23.11
 * Usage: Interface to C
 *
 * Software by: MVTec Software GmbH, www.mvtec.com
 ***********************************************************/


#ifndef __APPLE__
#  include "HalconC.h"
#else
#  ifndef HC_LARGE_IMAGES
#    include <HALCONC/HalconC.h>
#  else
#    include <HALCONCxl/HalconC.h>
#  endif
#endif


extern HUserImport int HHalcon_SoftwarePackageGetOffset();

int offset = -1;

Herror HcPreCallUser(int proc_index_local, Hproc_handle *proc_handle)
{
  Hproc_handle ph;
  if (offset < 0)
  {
    /* First use of this extension package, query my offset */
    offset = HHalcon_SoftwarePackageGetOffset();
    if (offset < 0)
    {
      /* HALCON library not initialized (extension package as first usage). */
      /* Trigger initialization by touching system operator and try again. */
      HcPreCall(0,&ph);
      HcPostCall(ph,H_MSG_OK);
      offset = HHalcon_SoftwarePackageGetOffset();
      if (offset < 0)
      {
        /* Ok, so something is *really* wrong */
        *proc_handle = NULL;
        return H_ERR_UEXTNI;
      }
    }
  }
  return HcPreCall(offset + proc_index_local, proc_handle);
}

HUserExport Herror T_sqlite3_loadOrSaveDb(const Htuple DbNumber, const Htuple zFilename, const Htuple isSave)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(0,&ph);
  if (err == H_MSG_OK) err = HcStoreICT(ph,0,&DbNumber);
  if (err == H_MSG_OK) err = HcStoreICTEnc(ph,1,&zFilename);
  if (err == H_MSG_OK) err = HcStoreICT(ph,2,&isSave);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror T_sqlite3_exec(const Htuple DbNumber, const Htuple sql, Htuple *errmsg)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(1,&ph);
  if (err == H_MSG_OK) err = HcStoreICT(ph,0,&DbNumber);
  if (err == H_MSG_OK) err = HcStoreICTEnc(ph,1,&sql);
  if (err == H_MSG_OK)
  {
    HcInitOCT(ph,0,errmsg);
    err = HcCall(ph);
  }
  err = HcStoreOCTEnc(ph,0,errmsg,err);
  return HcPostCall(ph,err);
}

HUserExport Herror T_sqlite3_get_table(const Htuple DbNumber, const Htuple sql, Htuple *table_names, Htuple *X, Htuple *Y, Htuple *errmsg)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(2,&ph);
  if (err == H_MSG_OK) err = HcStoreICT(ph,0,&DbNumber);
  if (err == H_MSG_OK) err = HcStoreICTEnc(ph,1,&sql);
  if (err == H_MSG_OK)
  {
    HcInitOCT(ph,0,table_names);
    HcInitOCT(ph,1,X);
    HcInitOCT(ph,2,Y);
    HcInitOCT(ph,3,errmsg);
    err = HcCall(ph);
  }
  err = HcStoreOCTEnc(ph,0,table_names,err);
  err = HcStoreOCT(ph,1,X,err);
  err = HcStoreOCT(ph,2,Y,err);
  err = HcStoreOCTEnc(ph,3,errmsg,err);
  return HcPostCall(ph,err);
}

HUserExport Herror T_sqlite3_close(const Htuple DbNumber)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(3,&ph);
  if (err == H_MSG_OK) err = HcStoreICT(ph,0,&DbNumber);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror T_sqlite3_open(const Htuple filename, Htuple *DbNumber)
{
  Hproc_handle ph;
  Herror err = H_MSG_OK;

  err = HcPreCallUser(4,&ph);
  if (err == H_MSG_OK) err = HcStoreICTEnc(ph,0,&filename);
  if (err == H_MSG_OK)
  {
    HcInitOCT(ph,0,DbNumber);
    err = HcCall(ph);
  }
  err = HcStoreOCT(ph,0,DbNumber,err);
  return HcPostCall(ph,err);
}

HUserExport Herror sqlite3_loadOrSaveDb(Hlong DbNumber, const char *zFilename, Hlong isSave)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(0,&ph);
  if (err == H_MSG_OK) HcStoreICL(ph,0,DbNumber);
  if (err == H_MSG_OK) HcStoreICSEnc(ph,1,zFilename);
  if (err == H_MSG_OK) HcStoreICL(ph,2,isSave);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror sqlite3_exec(Hlong DbNumber, const char *sql, char *errmsg)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(1,&ph);
  if (err == H_MSG_OK) HcStoreICL(ph,0,DbNumber);
  if (err == H_MSG_OK) HcStoreICSEnc(ph,1,sql);
  if (err == H_MSG_OK)
  {
    HcInitOCS(ph,0);
    err = HcCall(ph);
  }
  err = HcStoreOCSEnc(ph,0,errmsg,err);
  return HcPostCall(ph,err);
}

HUserExport Herror sqlite3_get_table(Hlong DbNumber, const char *sql, char *table_names, Hlong *X, Hlong *Y, char *errmsg)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(2,&ph);
  if (err == H_MSG_OK) HcStoreICL(ph,0,DbNumber);
  if (err == H_MSG_OK) HcStoreICSEnc(ph,1,sql);
  if (err == H_MSG_OK)
  {
    HcInitOCS(ph,0);
    HcInitOCL(ph,1);
    HcInitOCL(ph,2);
    HcInitOCS(ph,3);
    err = HcCall(ph);
  }
  err = HcStoreOCSEnc(ph,0,table_names,err);
  err = HcStoreOCL(ph,1,X,err);
  err = HcStoreOCL(ph,2,Y,err);
  err = HcStoreOCSEnc(ph,3,errmsg,err);
  return HcPostCall(ph,err);
}

HUserExport Herror sqlite3_close(Hlong DbNumber)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(3,&ph);
  if (err == H_MSG_OK) HcStoreICL(ph,0,DbNumber);
  if (err == H_MSG_OK)
  {
    err = HcCall(ph);
  }
  return HcPostCall(ph,err);
}

HUserExport Herror sqlite3_open(const char *filename, Hlong *DbNumber)
{
  Hproc_handle ph;
  Herror err;
  err = HcPreCallUser(4,&ph);
  if (err == H_MSG_OK) HcStoreICSEnc(ph,0,filename);
  if (err == H_MSG_OK)
  {
    HcInitOCL(ph,0);
    err = HcCall(ph);
  }
  err = HcStoreOCL(ph,0,DbNumber,err);
  return HcPostCall(ph,err);
}

